# 📍 클래스

저번 프로토타입 때 공부했던 것처럼, 자바스크립트는 프로토타입 기반 언어이기 때문에 ‘상속' 개념이 아닌 ‘원형' 개념이 존재한다고 했다. 하지만 클래스 기반 언어에 익숙한 개발자들을 위해 자바스크립트도 ES6에서 결국 클래스 문법을 추가하게 됐다.

하지만 ES6의 클래스 문법 역시 **프로토타입을 기반**으로 한 것이며 자바스크립트에서 클래스 상속을 구현했다는 것은 프로토타입 체이닝을 잘 연결한 것으로 이해하면 된다.

JS에서의 클래스는 단지 생성자-프로토타입 패턴을 숨기기 위한 Syntactic Sugar에 불과하며, JS는 여전히 프로토타입 기반 언어이다.

### ❓ 클래스 기반 언어와 JS에서 다루는 클래스의 동작 방식은 구체적으로 어떻게 다를까?

클래스 기반 언어에서 클래스란, **객체의 상태와 기능을 정의한 틀**이며, **생성될 객체에 대한 일종의 설계도**라고 할 수 있다.

그리고 이를 기반으로 생성된 객체를 인스턴스라고 한다. 여기서 **인스턴스는 클래스의 속성을 지니는 구체적인 사례이며,** 클래스에서 정의된 모든 특성에 대한 **복사본**이기 때문에 두 개념은 개별적이며, **서로 간의 참조는 존재하지 않는다.**

프로토타입 기반 언어에서는 클래스-인스턴스 개념이 아닌 오직 객체 개념만 존재한다. 또한 자바스크립트의 프로토타입 체계에서 ‘상속'이라는 표현이 적절치 않다고 보는 이유는,

클래스 기반 언어에서 상속은 copy에 기반한 동작인데 JS에서 객체들이 동작하는 방식은 copy에 기반한 게 아니라, **링크(`__proto__`)를 통한 위임**이라고 보는 것이 더 적절하기 때문이다.

### ❓ 클래스-인스턴스 개념이 아닌 오직 객체 개념만 존재한다?

자바스크립트에서 객체를 만드는 방법은 두 가지가 있다.

```jsx
var obj = {}; // 객체 리터럴
var obj2 = new Object(); // 생성자
```

둘 다 Object 타입을 갖는 객체로 Object 타입의 메서드인 `hasOwnProperty`나 `toString` 등을 사용할 수 있다.

지금 만들어진 객체가 Object 타입의 인스턴스 객체인 것도 맞지만 프로토타입을 이용한 상속을 지원하는 자바스크립트에서는 Object 생성자의 프로토타입을 상속받은 객체라고 하는 것이 더 정확하다.

사실 상속이라는 표현도 실제로는 링크드리스트 형태의 참조를 통한 **객체끼리의 연결**에 가깝고 클래스 매커니즘과 달리 정적이지 않고 매우 동적이다.

즉, 클래스-인스턴스 개념은 클래스의 속성을 상속받은 복제본, 즉 인스턴스를 생성하는 **계층적인 구조**이고, 객체 개념은 원형이 되는 객체의 프로토타입을 다른 객체가 참조하고 그 객체 또한 다른 객체의 원형이 될 수 있는 **연결 구조**이므로 둘의 상속이 다르다는 것을 알아야 한다.

### 클래스 문법 사용해보기

- 클래스 문법 사용 X

  ```jsx
  function Person(name) {
    this.name = name;
  }

  Person.eat = function () {
    console.log(`${this.name} : 냠냠!`);
  }; // static 메서드

  Person.prototype.say = function () {
    console.log(`안녕 나는 ${this.name}.`);
  }; // 프로토타입 메서드

  const me = new Person("정현이");
  Person.eat(); // Person : 냠냠!
  me.say(); // 안녕 나는 정현이.
  ```

- 클래스 문법 사용 O

  ```jsx
  class Person {
    constructor(name) {
      this.name = name;
    } // 생성자 함수

    static eat() {
      console.log(`${this.name} : 냠냠!`);
    } // static 메서드

    say() {
      console.log(`안녕 나는 ${this.name}.`);
    } // 자동으로 prototype 객체 내부에 할당되는 프로토타입 메서드
  }

  const me = new Person("정현이");
  Person.eat(); // Person : 냠냠!
  me.say(); // 안녕 나는 정현이.
  ```

클래스 문법을 사용하지 않고 클래스 상속을 흉내내기 위해서는 하위 클래스 객체의 `__proto__` 가 상위 클래스 객체의 `prototype` 을 참조하게 만들고, 하위 클래스 객체의 `prototype` 에는 불필요한 인스턴스 프로퍼티가 남아있지 않도록 만들어야 한다. 또한 `constructor` 프로퍼티가 가리키는 대상을 조정해야 한다.

ES6의 클래스 문법을 사용하면 `extends` 와 `super` 키워드를 통해 간단하게 처리할 수 있다.

### Class 선언

```jsx
class Person {
  constructor(name) {
    this.name = name;
  }
}
```

### Class 표현식

```jsx
const Person = class {
  constructor(name) {
    this.name = name;
  }
};
```

### 몇 가지 규칙

1. 클래스에서는 `constructor` 를 작동시키기 위해 `new` 키워드를 반드시 사용해야 한다.

   ```jsx
   function Person(name) {
     this.name = name;
   }

   const me = Person("정현"); // undefined (정상적으로 실행됨)
   ```

   ```jsx
   class Person {
   	constructor(name) {
   		this.name = name;
   }

   const me = Person('정현');
   // Uncaught TypeError: Class constructor Person cannot be invoked without 'new'
   // at <anonymous>
   ```

2. `constructor` 를 클래스 내에 추가하지 않으면 기본값으로 빈 `constructor` 가 자동으로 추가된다.
3. 클래스 선언은 호이스팅이 일어나지 않는다.(X) ➡️ 호이스팅이 일어나지 않는 것이 아니라, let 과 const 키워드처럼 동작한다. 따라서 선언 이전에 참조하면 ReferenceError가 발생한다.
4. 클래스는 객체 리터럴이나 생성자 함수 같은 것을 프로퍼티의 값으로 할당하는 것이 불가능하다. 함수나 getters/setters 만 가질 수 있다. (`property: value` 불가)

## 그래서, 왜?

프로토타입 기반의 자바스크립트에서 굳이 클래스를 사용하는 이유가 뭘까?

Syntactic sugar ; 문법적으로 기능은 그대로인데 코드의 양을 줄여주는, 또는 직관적으로 코드를 읽기 쉽게 만들어줌

- 예시
  가독성이 좋아지고 간단하게 코드 작성 가능
  ```jsx
  function Obj() {}
  Obj.prototype.method = function () {};
  ```
  ```jsx
  class Obj {
  	method: function () {}
  }
  ```

### JS에서의 Class 문법에 대한 비판

앞에서 말했듯이, 자바스크립트에 클래스 문법이 추가됐다고 해서 클래스 기반의 언어가 된 것은 아니다. 이러한 이유 때문에 클래스 문법은 단순히 편의를 위한 것이라는 비판을 받는다. 또한 고전적인 클래스 기반의 방법보다 프로토타입 기반이 훨씬 강력한 시스템이기 때문에 ‘클래스를 도입한 것은 최신 테슬라 모델을 1983년 포드 모델로 바꾸는 것과 같다’는 비판이 있다.

프로토타입 기반이 클래스 기반보다 강력하다는 것은 정적 타입과 동적 타입에 대한 이야기로 ,,

### 클래스 키워드는 피하는 게 맞을까?

프로토타입 방식은 링크를 통해 여러 객체의 프로퍼티를 동적으로 수정할 수 있어 리팩토링의 이점을 얻을 수 있지만 반대로 생각해보면 그로 인한 사이드 이펙트가 나타날 수도 있다.

정적 타입 언어와 동적 타입 언어에 대한 입장 차이이기 때문에 올바른 답은 없다고는 하지만,, 프로토타입 기반의 언어를 사용한다면 굳이 클래스를 사용하기보단 프로토타입을 활용하는 것이 맞다고 생각한다. (구체적인 견해를 얘기하려면 더 많은 경험이 필요하고 클래스 방식과 비교했을 때 프로토타입이 어떤 점에서 강력한 시스템이라고 할 수 있는지를 더 알아볼 필요가 있겠다 ..)

### 프로토타입 장단점

자바스크립트에서는 객체들이 프로토타입을 통해 프로퍼티를 공유하기 때문에 재사용성이 높아지고, 메모리 측면에서 굉장히 효율적이다.

또한 프로토타입 객체도 일반 객체와 같이 프로퍼티를 동적으로 추가/삭제할 수 있으며 즉시 프로토타입 체인에 반영된다.

하지만 수정이 용이한만큼, 정확성, 예측성 및 안정성 측면에서는 클래스보다 떨어진다. 예를 들어, 없을 거라고 생각한 속성이 이미 프로토타입에 존재해서 의도치 않은 결과가 나올 수 있다.

### Reference

[Prototype, 그리고 Class](https://tecoble.techcourse.co.kr/post/2021-06-14-prototype/)

[자바스크립트 개발자라면 알아야 할 33가지 개념 #14 자바스크립트 클래스의 내면](https://velog.io/@jakeseo_me/2019-05-03-1005-%EC%9E%91%EC%84%B1%EB%90%A8-evjv7dy8vh)

[[Javascript] Javascript에서 Class는 왜 사용하는걸까요?](https://park-answer.netlify.app/2020-01-13-javascript-class/)

[ES6 class 도입에 대한 이해 :: 마이구미](https://mygumi.tistory.com/235)

[쉽게 이해하는 자바스크립트 프로토타입 체인](https://ui.toast.com/weekly-pick/ko_20170217)
