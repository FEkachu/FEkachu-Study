# ğŸ“ ë¹„ë™ê¸° ì²˜ë¦¬

## ë¹„ë™ê¸°

ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” ì‹±ê¸€ ì“°ë ˆë“œ ì–¸ì–´ì´ë‹¤. ì¦‰, ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì½œ ìŠ¤íƒì´ í•˜ë‚˜ë¿ì´ë‹¤. ë”°ë¼ì„œ ì—¬ëŸ¬ ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•  ë•Œ ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê²Œ ë˜ë©´ í•˜ë‚˜ì˜ ì´ë²¤íŠ¸ê°€ ëë‚  ë•Œê¹Œì§€ ë‹¤ë¥¸ ì‘ì—…ì€ ëª¨ë‘ blockingë˜ì–´ ëŒ€ê¸°ì‹œê°„ì´ êµ‰ì¥íˆ ê¸¸ì–´ì§ˆ ê²ƒì´ë‹¤.

ë”°ë¼ì„œ ì‘ì—…ì´ ì¢…ë£Œë˜ì§€ ì•Šë”ë¼ë„ ëŒ€ê¸°í•˜ì§€ ì•Šê³  ë‹¤ìŒ ì‘ì—…ì„ ì‹¤í–‰í•˜ëŠ” ë¹„ë™ê¸°(Asynchronous) ë°©ì‹ìœ¼ë¡œ ë™ì‘í•œë‹¤. ë¹„ë™ê¸°ì˜ Non-blocking ì´ì  ë•Œë¬¸ì—, ë¹„ë™ê¸°ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ì™€ ê°™ì´ ì‹±ê¸€ ì“°ë ˆë“œ í™˜ê²½ì—ì„œ ì‹¤í–‰ë˜ëŠ” ì–¸ì–´ì—ì„œ ê´‘ë²”ìœ„í•˜ê²Œ ì‚¬ìš©ëœë‹¤.

í•˜ì§€ë§Œ ë¹„ë™ê¸°ëŠ” ì‹¤í–‰ ìˆœì„œê°€ ì •í•´ì ¸ ìˆì§€ ì•Šê¸° ë•Œë¬¸ì—, ì‘ì—…ì˜ ìˆœì„œê°€ ëª…í™•í•´ì•¼ í•˜ëŠ” ìƒí™©ì—ì„œëŠ” ì˜ˆê¸°ì¹˜ ëª»í•œ ê²°ê³¼ê°€ ë‚˜ì˜¬ ìˆ˜ ìˆë‹¤. ì´ëŸ¬í•œ ë¹„ë™ê¸° ì²˜ë¦¬ì˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ëª‡ ê°€ì§€ ë°©ì‹ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì.

## ë¹„ë™ê¸° ì²˜ë¦¬ ë°©ì‹ì˜ ë¬¸ì œì  í•´ê²°í•˜ê¸°

1. ì½œë°± í•¨ìˆ˜ ì‚¬ìš©
2. Promise ê°ì²´
3. Promiseë¥¼ í™œìš©í•œ async/await

## 1. ì½œë°± í•¨ìˆ˜ë¥¼ í†µí•œ ë¹„ë™ê¸° ì²˜ë¦¬

ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ëŠ” `setTimeout()` ì´ë¼ëŠ” ëŒ€í‘œì ì¸ ë‚´ì¥ ë¹„ë™ê¸° í•¨ìˆ˜ê°€ ìˆë‹¤.

ì‹¤ì œ í”„ë¡œì íŠ¸ì—ì„œëŠ” DBë‚˜ APIë¥¼ í†µí•´ì„œ ë°ì´í„°ë¥¼ ì–»ì–´ì˜¤ëŠ” ê²½ìš° ì§€ì—° ì‹œê°„ì´ ë°œìƒí•˜ê²Œ ë˜ëŠ”ë°, `setTimeout()` ì„ ì´ìš©í•´ ì´ëŸ° ìƒí™©ì„ ì‹œë®¬ë ˆì´ì…˜ í•´ë³¼ ìˆ˜ ìˆë‹¤.

```jsx
// setTimeoutì„ ì´ìš©í•´ findUser ìˆ˜ì •
function findUser(id) {
  let user;
  setTimeout(function () {
    console.log("waited 0.1 sec.");
    user = {
      id: id,
      name: "User" + id,
      email: id + "@test.com",
    };
  }, 100);
  return user;
}

const user = findUser(1);
console.log("user: ", user);
// user: undefined
// waited 0.1 sec.
```

`setTimeout()` ì€ ë¹„ë™ê¸° í•¨ìˆ˜ì´ê¸° ë•Œë¬¸ì— ì‹¤í–‰ì´ ì™„ë£Œë˜ì§€ ì•Šë”ë¼ë„ ë‹¤ìŒ ë¼ì¸ì¸ `return user` ë¡œ ë„˜ì–´ê°€ë²„ë¦°ë‹¤. ë”°ë¼ì„œ `user` ê°€ í• ë‹¹ì´ ë˜ê¸° ì „ì— ë¦¬í„´ì´ ë¼ë²„ë¦¬ê³  ê²°ê³¼ëŠ” undefinedê°€ ë‚˜ì˜¨ë‹¤.

ì´ì™€ ê°™ì€ ìƒí™©ì€ ì½œë°± í•¨ìˆ˜ë¥¼ ì´ìš©í•´ì„œ í•´ê²°í•  ìˆ˜ ìˆë‹¤. í•¨ìˆ˜ë¡œë¶€í„° ê²°ê³¼ê°’ì„ ë¦¬í„´ë°›ì§€ ì•Šê³ , ê²°ê³¼ê°’ì„ ì´ìš©í•´ ì²˜ë¦¬í•  ë¡œì§ì„ ì½œë°± í•¨ìˆ˜ì— ë‹´ì•„ ì¸ìë¡œ ë„˜ê²¨ì£¼ëŠ” ê²ƒì´ë‹¤.

```jsx
function findUserAndCallBack(id, cb) {
  setTimeout(function () {
    console.log("waited 0.1 sec.");
    const user = {
      id: id,
      name: "User" + id,
      email: id + "@test.com",
    };
    cb(user);
  }, 100);
}

findUserAndCallBack(1, function (user) {
  console.log("user:", user);
});
// waited 0.1 sec.
// user: {id: 1, name: 'User1', email: '1@test.com'}
```

`findUserAndCallBack()` í•¨ìˆ˜ì˜ ë‘ ë²ˆì§¸ ì¸ìë¡œ ê²°ê³¼ê°’ì„ ì´ìš©í•´ì„œ ì‹¤í–‰í•  ë¡œì§ì„ ë„˜ê²¨ì£¼ì—ˆê³ , `setTimeout()` í•¨ìˆ˜ëŠ” 0.1ì´ˆê°€ ì§€ë‚œ í›„ ì´ ì½œë°± í•¨ìˆ˜ë¥¼ í˜¸ì¶œí–ˆë‹¤.

ì´ì™€ ê°™ì´ ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ë•ŒëŠ” ê²°ê³¼ê°’ì„ ë¦¬í„´ ë°›ìœ¼ë ¤ê³  í•˜ì§€ ë§ê³ , ê²°ê³¼ê°’ì„ ê°€ì§€ê³  ì²˜ë¦¬í•  ë¡œì§ì„ ì½œë°± í•¨ìˆ˜ë¡œ ë„˜ê¸°ëŠ” ìŠ¤íƒ€ì¼ë¡œ ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼ ì˜ˆìƒëœ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.

### ì½œë°± í•¨ìˆ˜ë¥¼ í†µí•œ ë¹„ë™ê¸° ì²˜ë¦¬ì˜ ë¬¸ì œì 

ë‹¨ìˆœí•œ ì½”ë“œì—ì„  ë³„ ë¬¸ì œê°€ ì—†ê² ì§€ë§Œ, ì½œë°± í•¨ìˆ˜ë¥¼ ì¤‘ì²©í•´ì„œ ì—°ì‡„ì ìœ¼ë¡œ í˜¸ì¶œí•´ì•¼ í•˜ëŠ” ë³µì¡í•œ ì½”ë“œì˜ ê²½ìš° ìˆ˜ë§ì€ ë“¤ì—¬ì“°ê¸°ì™€ ê´„í˜¸ ë•Œë¬¸ì— ì½”ë“œì˜ ê°€ë…ì„±ì´ í˜„ì €íˆ ë–¨ì–´ì§€ê²Œ ëœë‹¤. (ì½œë°± ì§€ì˜¥..)

ë”°ë¼ì„œ ì½œë°± í•¨ìˆ˜ ëŒ€ì‹  `Promise` ë‚˜ `async/await` ë¥¼ ì´ìš©í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ëŒ€ì²´í•  ìˆ˜ ìˆë‹¤.

## 2. Promise

### Promiseë€?

PromiseëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¹„ë™ê¸° ì²˜ë¦¬ì— ì‚¬ìš©ë˜ëŠ” ê°ì²´ì´ë‹¤. ë¹„ë™ê¸° ì‘ì—…ì´ ì„±ê³µ ë˜ëŠ” ì‹¤íŒ¨ë¡œ ì™„ë£Œëœ í›„ì˜ ê²°ê³¼ê°’ ë˜ëŠ” ì˜ˆì™¸ê°’ì„ ë°›ì„ ìˆ˜ ìˆë‹¤. ë¦¬í„´ ë°›ì€ ê²°ê³¼ê°’/ì˜ˆì™¸ê°’ì„ ê°€ì§€ê³  ì‘ì—…ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.

ëŒ€í‘œì ìœ¼ë¡œ I/Oë‚˜ Networkë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ì–»ëŠ” ê²½ìš° ì§€ì—°ì‹œê°„ì´ ë°œìƒí•˜ê²Œ ë˜ëŠ”ë°, CPU ì…ì¥ì—ì„œëŠ” ì´ ì§€ì—°ì‹œê°„ì´ êµ‰ì¥íˆ ê¸¸ê²Œ ì—¬ê²¨ì§€ê¸° ë•Œë¬¸ì— Non-blocking ì½”ë“œë¥¼ ì§€í–¥í•˜ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ë¹„ë™ê¸° ì²˜ë¦¬ëŠ” í•„ìˆ˜ì´ë‹¤.

ìœ„ì—ì„œ ì‘ì„±í•œ `findUser` ì½”ë“œë¥¼ Promiseë¥¼ ì´ìš©í•´ ë‹¤ìŒê³¼ ê°™ì´ ì“¸ ìˆ˜ ìˆë‹¤.

```jsx
findUser(1).then(function (user) {
  console.log("user:", user);
});

function findUser(id) {
  return new Promise(function (resolve) {
    setTimeout(function () {
      console.log("waited 0.1 sec.");
      const user = {
        id: id,
        name: "User" + id,
        email: id + "@test.com",
      };
      resolve(user);
    }, 100);
  });
}
```

ìœ„ ì½”ë“œëŠ” ì½œë°± í•¨ìˆ˜ë¥¼ ì¸ìë¡œ ë„˜ê¸°ëŠ” ëŒ€ì‹ ì— `findUser()` í•¨ìˆ˜ê°€ Promise ê°ì²´ë¥¼ ìƒì„±í•´ ë¦¬í„´í•˜ì˜€ê³ , í˜¸ì¶œë¶€ì—ì„œëŠ” ë¦¬í„´ë°›ì€ Promise ê°ì²´ì— `then()` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•´ ê²°ê³¼ê°’ì„ ê°€ì§€ê³  ì‹¤í–‰í•  ë¡œì§ì„ ë„˜ê²¨ì£¼ê³  ìˆë‹¤.

ì½œë°± í•¨ìˆ˜ì™€ì˜ ì°¨ì´ì ì€, í•¨ìˆ˜ê°€ Promise ê°ì²´ë¥¼ ë¦¬í„´í•˜ê³  ë¦¬í„´ëœ ê²°ê³¼ê°’ì„ ê°€ì§€ê³  ë¡œì§ì„ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— ë¹„ë™ê¸°ì„ì—ë„ ë¶ˆêµ¬í•˜ê³  ë™ê¸°ì²˜ëŸ¼ ì½”ë“œê°€ ì½íˆê¸° ë•Œë¬¸ì— ì¢€ ë” ì§ê´€ì ì´ë¼ëŠ” ê²ƒì´ë‹¤.

### Promise ìƒì„± ë°©ë²•

ë¨¼ì € Promise ê°ì²´ë¥¼ ë¦¬í„´í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì‘ì„±í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ì.

Promise ê°ì²´ëŠ” **`new Promise()` ë¥¼ í†µí•´ ìƒì„±í•  ìˆ˜ ìˆëŠ”ë° ì´ ìƒì„±ìëŠ” í•¨ìˆ˜ë¥¼ ì¸ìë¡œ ë°›ëŠ”ë‹¤.**

ê·¸ë¦¬ê³  ì´ í•¨ìˆ˜ëŠ” **`resolve` ì™€ `reject` ë¼ëŠ” ë‘ ê°œì˜ í•¨ìˆ˜í˜• ì¸ì**ë¥¼ ê°€ì§„ë‹¤.

Promise ê°ì²´ë¥¼ ìƒì„±í•´ì„œ ë³€ìˆ˜í•´ í• ë‹¹í•´ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ë°, ì‹¤ì œë¡œëŠ” ê·¸ëƒ¥ ë¦¬í„´ê°’ì— ë°”ë¡œ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ë§ê³ , í™”ì‚´í‘œ í•¨ìˆ˜ë¥¼ ë§ì´ ì‚¬ìš©í•œë‹¤.

```jsx
function returnPromise() {
	return new Promise((resolve, reject) => { ... } );
}
```

í•¨ìˆ˜ ì¸ìì˜ ë°”ë””ì—ì„œëŠ” `resolve()`ë‚˜ `reject()` í•¨ìˆ˜ë¥¼ ìƒí™©ì— ë”°ë¼ ì ì ˆíˆ í˜¸ì¶œí•´ì¤˜ì•¼ í•œë‹¤.

- `resolve(value)` : ì‘ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ëë‚œ ê²½ìš° ê·¸ ê²°ê³¼ë¥¼ ë‚˜íƒ€ë‚´ëŠ” valueì™€ í•¨ê»˜ í˜¸ì¶œí•œë‹¤.
- `reject(error)` : ì—ëŸ¬ ë°œìƒ ì‹œ ì—ëŸ¬ ê°ì²´ë¥¼ ë‚˜íƒ€ë‚´ëŠ” errorì™€ í•¨ê»˜ í˜¸ì¶œí•œë‹¤.

ì˜ˆì œë¥¼ í†µí•´ ì‚´í´ë³´ì.

```jsx
function devide(numA, numB) {
  return new Promise((resolve, reject) => {
    if (numB === 0) reject(new Error("0ìœ¼ë¡œ ë‚˜ëˆŒ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."));
    else resolve(numA / numB);
  });
}

// ì •ìƒì ì¸ ì¸ì ë„˜ê¸°ê¸°
devide(8, 2)
  .then((result) => console.log("ì„±ê³µ:", result))
  .catch((error) => console.log("ì‹¤íŒ¨:", error));
// ì„±ê³µ: 4

// ë¹„ì •ìƒì ì¸ ì¸ì ë„˜ê¸°ê¸°
devide(8, 0)
  .then((result) => console.log("ì„±ê³µ:", result))
  .catch((error) => console.log("ì‹¤íŒ¨:", error));
// ì‹¤íŒ¨: Error: 0ìœ¼ë¡œ ë‚˜ëˆŒ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
//     at <anonymous>:3:26
//     at new Promise (<anonymous>)
//     at devide (<anonymous>:2:9)
//     at <anonymous>:16:1
```

ì •ìƒì ì¸ ì¸ìë¥¼ ë„˜ê¸´ ê²½ìš° `then()` ë©”ì„œë“œê°€ í˜¸ì¶œë˜ê³ , ë¹„ì •ìƒì ì¸ ì¸ìë¥¼ ë„˜ê¸´ ê²½ìš° `catch()` ë©”ì„œë“œê°€ í˜¸ì¶œë˜ì—ˆë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.

### Promise ì‚¬ìš© ë°©ë²•

ì‹¤ì œ ì½”ë”©ì„ í•  ë•ŒëŠ” ìœ„ì™€ ê°™ì´ Promise ê°ì²´ë¥¼ ì§ì ‘ ìƒì„±í•´ì„œ ë¦¬í„´í•´ì£¼ëŠ” ì½”ë“œë³´ë‹¤ëŠ” ì–´ë–¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ì„œ ë¦¬í„´ë°›ì€ Promise ê°ì²´ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ë” ë§ì„ ê²ƒì´ë‹¤.

REST APIë¥¼ í˜¸ì¶œí•  ë•Œ ì‚¬ìš©ë˜ëŠ” ë¸Œë¼ìš°ì € ë‚´ì¥ í•¨ìˆ˜ì¸ `fetch()` ê°€ ëŒ€í‘œì ì¸ë°, `fetch()` í•¨ìˆ˜ëŠ” APIì˜ URLì„ ì¸ìë¡œ ë°›ê³ , ë¯¸ë˜ ì‹œì ì— ì–»ê²Œ ë  API í˜¸ì¶œ ê²°ê³¼ë¥¼ Promise ê°ì²´ë¡œ ë¦¬í„´í•œë‹¤.

Promise ê°ì²´ë¡œë¶€í„° ì–»ê²Œ ë  ê²°ê³¼ê°’ì´ë‚˜ ì˜ˆì™¸ê°’ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” `then()` ë©”ì„œë“œì™€ `catch()` ë©”ì„œë“œì— ëŒ€í•´ ì•Œì•„ë³´ì.

- `then()`
  í”„ë¼ë¯¸ìŠ¤ê°€ ì •ìƒì ìœ¼ë¡œ ì¢…ë£Œë˜ë©´ ì²˜ë¦¬ ê²°ê³¼ê°’ì„ ë°›ì„ ìˆ˜ ìˆë‹¤.
- `catch()`
  ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´ ì—ëŸ¬ê°’ì„ ë°›ì„ ìˆ˜ ìˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, `fetch()` í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ì–´ë–¤ ì„œë¹„ìŠ¤ì˜ APIë¥¼ í˜¸ì¶œí•˜ê³ , ì •ìƒ ì‘ë‹µ ê²°ê³¼ë¥¼ ì¶œë ¥í•´ë³´ê² ë‹¤.

```jsx
fetch("https://jsonplaceholder.typicode.com/posts/1")
  .then((response) => console.log("response:", response))
  .catch((error) => console.log("error:", error));

// response: Response {type: "cors", url: "https://jsonplaceholder.typicode.com/posts/1", redirected: false, status: 200, ok: true, â€¦}
```

ì˜ˆì™¸ê°€ ë°œìƒí•˜ì§€ ì•Šê³  `then()` ì— ì¸ìë¡œ ë„˜ê¸´ ì½œë°± í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì—ˆë‹¤.

ì´ë²ˆì—ëŠ” `fetch()` í•¨ìˆ˜ì˜ ì¸ìë¡œ ì•„ë¬´ê²ƒë„ ë„˜ê¸°ì§€ ì•Šì•„ë³´ê² ë‹¤.

```jsx
fetch()
  .then((response) => console.log("response:", response))
  .catch((error) => console.log("error:", error));

// error: TypeError: Failed to execute 'fetch' on 'Window': 1 argument required, but only 0 present.
//    at <anonymous>:1:1
```

ì˜ˆì™¸ê°€ ë°œìƒí•´ `catch()` ì— ì¸ìë¡œ ë„˜ê¸´ ì½œë°± í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì—ˆë‹¤.

ì´ì™€ ê°™ì´ PromiseëŠ” `then()` ê³¼ `catch()` ë©”ì„œë“œë¥¼ í†µí•´ì„œ ë™ê¸° ì²˜ë¦¬ ì½”ë“œì—ì„œ ì‚¬ìš©í•˜ë˜ `try-catch` ë¸”ë¡ê³¼ ìœ ì‚¬í•œ ë°©ë²•ìœ¼ë¡œ ë¹„ë™ê¸° ì²˜ë¦¬ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.

### Promiseì˜ ì„¸ ê°€ì§€ ìƒíƒœ (states)

- Pending(ëŒ€ê¸°) : ë¹„ë™ê¸° ì²˜ë¦¬ ë¡œì§ì´ ì•„ì§ ì™„ë£Œë˜ì§€ ì•Šì€ ìƒíƒœ
- Fulfilled(ì´í–‰) : ë¹„ë™ê¸° ì²˜ë¦¬ê°€ ì™„ë£Œë˜ì–´ í”„ë¼ë¯¸ìŠ¤ê°€ ê²°ê³¼ ê°’ì„ ë°˜í™˜í•´ì¤€ ìƒíƒœ. `resolve()` ë¥¼ ì‹¤í–‰í•˜ë©´ ì´í–‰ ìƒíƒœê°€ ëœë‹¤. ì´í–‰ ìƒíƒœê°€ ë˜ë©´ `then()` ì„ ì´ìš©í•´ ê²°ê³¼ê°’ì„ ë°›ì„ ìˆ˜ ìˆë‹¤.
- Rejected(ì‹¤íŒ¨) : ë¹„ë™ê¸° ì²˜ë¦¬ê°€ ì‹¤íŒ¨í•˜ê±°ë‚˜ ì˜¤ë¥˜ê°€ ë°œìƒí•œ ìƒíƒœ. `reject()` ë¥¼ ì‹¤í–‰í•˜ë©´ ì‹¤íŒ¨ ìƒíƒœê°€ ëœë‹¤.

![Untitled](https://joshua1988.github.io/images/posts/web/javascript/promise.svg)

(í”„ë¼ë¯¸ìŠ¤ ì²˜ë¦¬ íë¦„ - MDN)

### Promiseì˜ ë©”ì„œë“œ ì²´ì´ë‹ (Method Chaining)

`then()` ê³¼ `catch()` ë©”ì„œë“œëŠ” ë˜ë‹¤ë¥¸ Promise ê°ì²´ë¥¼ ë¦¬í„´í•œë‹¤. ì´ë¥¼ í†µí•´ `then()`, `catch()` ë©”ì„œë“œë¥¼ ì—°ì‡„ì ìœ¼ë¡œ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.

```jsx
fetch("https://jsonplaceholder.typicode.com/posts/1")
  .then((response) => response.json()) // (1)
  .then((post) => post.userId) // (2)
  .then((userId) => "https://jsonplaceholder.typicode.com/users/" + userId) // (3)
  .then((url) => fetch(url)) // (4)
  .then((response) => response.json())
  .then((user) => console.log("user:", user))
  .catch((error) => console.log("error:", error));
```

(1) ì‘ë‹µ ê²°ê³¼ë¥¼ json í˜•íƒœë¡œ ë³€í™˜

(2) post ê°ì²´ì—ì„œ userId í•„ë“œë§Œ ì¶”ì¶œí•´ ë¦¬í„´

(3) ë¦¬í„´ëœ userIdë¥¼ ê°€ì§€ê³  ìœ ì € ì •ë³´ ì¡°íšŒë¥¼ ìœ„í•œ URL ìƒì„± í›„ ë¦¬í„´

(4) ë¦¬í„´ëœ URLë¡œ ë‹¤ì‹œ `fetch()` í•¨ìˆ˜ í˜¸ì¶œ, Promise ë¦¬í„´

`then()` ê³¼ `catch()` ì˜ ì¸ìë¡œ ë„˜ê¸´ ì½œë°± í•¨ìˆ˜ëŠ” (2), (3)ì²˜ëŸ¼ ì¼ë°˜ ê°ì²´ë¥¼ ë¦¬í„´í•˜ë“  (4)ì²˜ëŸ¼ Promise ê°ì²´ë¥¼ ë¦¬í„´í•˜ë“  í¬ê²Œ ìƒê´€ì´ ì—†ë‹¤. ì™œëƒí•˜ë©´ ì¼ë°˜ ê°ì²´ë¥¼ ë¦¬í„´í•  ê²½ìš° `then()` ê³¼ `catch()` ëŠ” í•­ìƒ ê·¸ ê°ì²´ë¥¼ ì–»ì„ ìˆ˜ ìˆëŠ” Promise ê°ì²´ë¥¼ ë¦¬í„´í•˜ë„ë¡ ë˜ì–´ìˆê¸° ë•Œë¬¸ì´ë‹¤.

### Promiseì˜ ë¬¸ì œì 

ë™ì¼í•œ ì´ë¦„ì˜ ë©”ì„œë“œì¸ `then()` ì„ ì—°ì‡„ì ìœ¼ë¡œ í˜¸ì¶œí•˜ê³  ìˆì–´ì„œ, ì–´ë””ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí–ˆëŠ”ì§€ í•œ ë²ˆì— ì•Œê¸°ê°€ ì–´ë µë‹¤.

ë˜í•œ í™”ì‚´í‘œ í•¨ìˆ˜ë¡œ í•œ ì¤„ì§œë¦¬ ì½œë°± í•¨ìˆ˜ë¥¼ ë„˜ê¸´ ê²½ìš° `then()` ë©”ì„œë“œ í˜¸ì¶œë¶€ì— break pointë¥¼ ê±¸ì–´ë„ ì½”ë“œ ì‹¤í–‰ì´ break pointì—ì„œ ë©ˆì¶”ì§€ ì•Šê¸° ë•Œë¬¸ì— ë””ë²„ê¹…ì´ ìƒë‹¹íˆ ë¶ˆí¸í•˜ë‹¤.

ì˜ˆì™¸ ì²˜ë¦¬ì˜ ê²½ìš° `try-catch` ëŒ€ì‹  `catch()` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ í•´ì¤˜ì•¼ í•˜ëŠ”ë°, ë™ê¸° ì½”ë“œì™€ ë¹„ë™ê¸° ì½”ë“œê°€ ì„ì—¬ ìˆì„ ê²½ìš°ì—ëŠ” ì˜ˆì™¸ ì²˜ë¦¬ê°€ ë‚œí•´í•´ì§€ê±°ë‚˜ ëˆ„ë½ë˜ëŠ” ê²½ìš°ê°€ ìƒê¸°ê¸° ì‰½ë‹¤.

ì‹¤ì œ í”„ë¡œì íŠ¸ì—ì„œ ë³µì¡í•œ êµ¬ì¡°ì˜ ë¹„ë™ê¸° ì²˜ë¦¬ ì½”ë“œë¥¼ ì‘ì„±í•˜ê²Œ ë˜ë©´ ë“¤ì—¬ì“°ê¸°ê°€ ë§ì•„ì ¸ ì½”ë“œ ê°€ë…ì„±ì´ ë–¨ì–´ì§„ë‹¤.

## 3. async/await

Promiseì˜ ë‹¨ì ë“¤ì„ í•´ê²°í•˜ê¸° ìœ„í•´ ES7ì—ì„œ async/await í‚¤ì›Œë“œê°€ ì¶”ê°€ë˜ì—ˆë‹¤. ì´ í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ë©´ ë¹„ë™ê¸° ì½”ë“œë¥¼ ë§ˆì¹˜ ë™ê¸° ì½”ë“œì²˜ëŸ¼ ë³´ì´ê²Œ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.

### async

- `async` ëŠ” `function` ì•ì— ìœ„ì¹˜í•œë‹¤.
- `function` ì•ì— `async` ë¥¼ ë¶™ì´ë©´ í•´ë‹¹ í•¨ìˆ˜ëŠ” í•­ìƒ Promiseë¥¼ ë°˜í™˜í•œë‹¤.
- í”„ë¼ë¯¸ìŠ¤ê°€ ì•„ë‹Œ ê°’ì„ ë°˜í™˜í•˜ë”ë¼ë„ ì´í–‰ ìƒíƒœì˜ í”„ë¼ë¯¸ìŠ¤ë¡œ ê°’ì„ ê°ì‹¸ ì´í–‰ëœ í”„ë¼ë¯¸ìŠ¤(resolved promise)ê°€ ë°˜í™˜ë˜ë„ë¡ í•œë‹¤.

### await

- `await` ëŠ” `async` í•¨ìˆ˜ ì•ˆì—ì„œë§Œ ë™ì‘í•œë‹¤.
- ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” `await` í‚¤ì›Œë“œë¥¼ ë§Œë‚˜ë©´ í”„ë¼ë¯¸ìŠ¤ê°€ ì™„ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦°ë‹¤.
- í”„ë¼ë¯¸ìŠ¤ê°€ ì²˜ë¦¬ë˜ê¸¸ ê¸°ë‹¤ë¦¬ëŠ” ë™ì•ˆ ì—”ì§„ì€ ë‹¤ë¥¸ ì¼ì„ í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— CPU ë¦¬ì†ŒìŠ¤ê°€ ë‚­ë¹„ë˜ì§€ëŠ” ì•ŠëŠ”ë‹¤.

```jsx
// Promise
function fetchAuthorName(postId) {
  return fetch(`https://jsonplaceholder.typicode.com/posts/${postId}`)
    .then((response) => response.json())
    .then((post) => post.userId)
    .then((userId) => {
      return fetch(`https://jsonplaceholder.typicode.com/users/${userId}`)
        .then((response) => response.json())
        .then((user) => user.name);
    });
}

fetchAuthorName(1).then((name) => console.log("name:", name));
```

```jsx
// async/await
async function fetchAuthorName(postId) {
  const postResponse = await fetch(
    `https://jsonplaceholder.typicode.com/posts/${postId}`
  );
  const post = await postResponse.json();
  const userId = post.userId;
  const userResponse = await fetch(
    `https://jsonplaceholder.typicode.com/users/${userId}`
  );
  const user = await userResponse.json();
  return user.name;
}

fetchAuthorName(1).then((name) => console.log("name:", name));
```

ë‹¬ë¼ì§„ ì ì„ ì°¾ì•„ë³´ë©´, **`function` ì•ì— `async` í‚¤ì›Œë“œê°€ ì¶”ê°€**ëê³ , Promiseë¥¼ ë¦¬í„´í•˜ëŠ” ëª¨ë“  **ë¹„ë™ê¸° í•¨ìˆ˜ í˜¸ì¶œ ì•ì—ëŠ” `await` í‚¤ì›Œë“œê°€ ì¶”ê°€**ëë‹¤.

`async` í‚¤ì›Œë“œê°€ ë¶™ì€ í•¨ìˆ˜ëŠ” í•­ìƒ Promise ê°ì²´ë¥¼ ë¦¬í„´í•˜ê¸° ë•Œë¬¸ì— í˜¸ì¶œë¶€ì—ì„œ `fetchAuthorName()` ì„ í˜¸ì¶œí•˜ê³  `then()` ë©”ì„œë“œë¥¼ í†µí•´ ê²°ê³¼ê°’ì„ ì¶œë ¥í•˜ê³  ìˆë‹¤.

ë§Œì•½ ë˜ë‹¤ë¥¸ `async` í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ `fetchAuthorName()` ì„ í˜¸ì¶œí•œë‹¤ë©´ í˜¸ì¶œë¶€ ì•ì— `await` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

```jsx
async function printAuthorName(postId) {
  const name = await fetchAuthorName(postId);
  console.log("name:", name);
}

printAuthorName(1);
```

### ì˜ˆì™¸ ì²˜ë¦¬

`async/await` ë¥¼ ì‚¬ìš©í•˜ë©´ ë™ê¸°/ë¹„ë™ê¸° êµ¬ë¶„ ì—†ì´ `try/catch` ë¡œ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆë‹¤.

```jsx
async function fetchAuthorName(postId) {
  const postResponse = await fetch(
    `https://jsonplaceholder.typicode.com/posts/${postId}`
  );
  const post = await postResponse.json();
  const userId = post.userId;

  try {
    const userResponse = await fetch(
      `https://jsonplaceholder.typicode.com/users/${userId}`
    );
    const user = await userResponse.json();
    return user.name;
  } catch (err) {
    console.log("Fail to fetch user:", err);
    return "Unknown";
  }
}

fetchAuthorName(1).then((name) => console.log("name:", name));
```

### Reference

[[ìë°”ìŠ¤í¬ë¦½íŠ¸] ë¹„ë™ê¸° ì²˜ë¦¬ 1ë¶€ - Callback](https://www.daleseo.com/js-async-callback/#%EC%BD%9C%EB%B0%B1-%ED%95%A8%EC%88%98)

[[ìë°”ìŠ¤í¬ë¦½íŠ¸] ë¹„ë™ê¸° ì²˜ë¦¬ 2ë¶€ - Promise](https://www.daleseo.com/js-async-promise/)

[[ìë°”ìŠ¤í¬ë¦½íŠ¸] ë¹„ë™ê¸° ì²˜ë¦¬ 3ë¶€ - async/await](https://www.daleseo.com/js-async-async-await/)

[ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¹„ë™ê¸° ì²˜ë¦¬ ë°©ì‹](https://velog.io/@yejinh/%EB%B9%84%EB%8F%99%EA%B8%B0-%ED%8C%8C%ED%97%A4%EC%B9%98%EA%B8%B0)

[ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°](https://www.howdy-mj.me/javascript/asynchronous-programming/)

[How JavaScript works: Event loop and the rise of Async programming + 5 ways to better coding with...](https://blog.sessionstack.com/how-javascript-works-event-loop-and-the-rise-of-async-programming-5-ways-to-better-coding-with-2f077c4438b5)

[asyncì™€ await](https://ko.javascript.info/async-await)
