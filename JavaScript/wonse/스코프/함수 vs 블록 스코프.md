앞서 스코프에 대해 정리할 때 **스코프 버블**이라는 용어를 사용하였다. 스코프 버블은 스코프의 컨테이너 또는 바구니의 개념으로 그 경계는 분명하게 중첩되고, 프로그래머가 코드를 작성할 때 결정된다.

일반적으로 자바스크립트는 함수 기반 스코프를 사용한다고 알고 있다. 함수 스코프는 모든 변수가 함수에 속하고 함수 전체에 걸쳐 사용되며 재사용된다는 개념을 확고하게 한다. 하지만 이 점은 스코프 전체에서 변수가 살아있다는 점에서 예상치 못한 위험을 일으키는 지점이 될 수 있다.

## 1. 최소 권한의 법칙

이런 재사용의 위험에서부터 안전하기 위해 소프트웨어 디자인 원칙 중에 **최소 권한의 원칙**이 있다. 이 원칙은 모듈/객체의 API와 같은 소프트웨어를 설계할 때 필요한 것만 최소한으로 남기고 나머지는 숨겨야한다는 것이다. 이 숨기는 과정을 스코프를 통해 설계할 수 있다. 최소 권한의 법칙에 대해 더 찾아볼까 했는데 별 자료가 나오지 않아 이 정도의 개념으로 남겨두면 될 듯 하다. 개발을 할 때 최소 권한을 주는 것이 아니라 이 함수에서도 저 함수에서도 접근할 수 있는 친구들을 만들 때가 꽤 많은데, 당장 개발할 때 정말 편할지 몰라도 이렇게 되면 나중에 디버깅할때 정말 힘들어진다.

최소 권한의 법칙에 의해 소프트웨어를 설계하면 변수의 이름들이 같아서 생기는 충돌을 회피할 수 있다. 항상 다른 이름의 변수를 선언하는 것은 어려운 일이다. 하지만 이를 스코프를 통해 잘 숨겨두면 충돌을 피할 수 있다는 이야기이다.

**모듈**도 사실 충돌 방지 옵션 중 하나라고 볼 수 있다. 모듈을 사용하면 어떤 라이브러리를 사용하더라도 확인자를 글로벌로 추가할 필요 없이, 특정 스코프로부터 확인자를 가져와 사용할 수 있다.

## 2. 스코프 역할을 하는 함수

함수를 익명으로 선언하고 자동으로 실행하는 방식이 있다. 나는 이것을 처음 접할 때 **즉시 실행 함수**라고 접하였다.

```jsx
let a = 2;

(function foo() {
	let a = 3;
  console.log(a); // 3
})();

console.log(a); // 2
```

위 코드에서 함수 이름 foo는 함수를 둘러싼 스코프에 묶이는 대신 함수 자신의 내부 스코프에 묶였다. 따라서 함수 이름 foo는 오직 그 안의 스코프에서만 찾을 수 있고 바깥 스코프에서는 찾을 수 없다.

## 3. 스코프 역할을 하는 블록

함수 스코프만이 있는 것이 아니다. 우리는 실제로 코딩할 때 블록 스코프에 익숙하다. 대표적인 예시가 for문이다. 우리는 다음과 같은 코드를 당연하게 사용하고 있다.

```jsx
for (var i = 0; i < 10; i++) {
	console.log(i);
}
```

하지만 위 코드는 실제 블록 스코프가 아니라 그렇게 보일 뿐이다. `var`키워드로 선언했기 때문에 스코프 전체가 오염된다. 자바스크립트에서 블록 스코프를 사용할 수 있는 방법에는 여러가지가 있는데 그 중 가장 일반적으로 사용하는 것이 바로 `let`과 `const`이다.

### a. let

키워드 let으로 선언한 변수를 블록을 통해 감싸면 그 변수는 블록 스코프를 가진다고 할 수 있다. 또한 let을 사용한 선언문은 속하는 스코프에서 호이스팅 효과를 받지 않아 실제 선언문 전에는 존재하지 않는다.

### b. const

키워드 const로 선언한 변수는 블록 스코프를 생성하며 선언된 값은 고정된다.

그렇다면 let과 const만 남기고 var는 없애면 편하지 않을까라는 생각을 하게 된다. 하지만 블록 스코프는 var 함수 스코프를 완전히 대체할 수 없다. 두 기능은 공존하며 개발자들은 함수 스코프와 블록 스코프 기술을 같이 사용할 수 있어야 한다.

이 책의 저자는 자신은 var를 사랑하며 앞으로도 유용할 것이며 잘못된 설계가 아니라고 한다. 하지만 많은 사람들은 var를 사용하지 말라고 권장하며 심지어 린트 설정에도 그렇게 되어있다. 사실 조금 혼란스럽다. var를 사용할 일이 뭐가 있을까? 모던 자바스크립트 코드에서 var를 잘 본 기억도 없다. 해봤자 let과 const로 선언한 변수들을 바벨로 트랜스파일링했을때 var로 바뀌는 정도..? 개발 단계에서 일부러 var를 사용할 일이 있을까?

[You-Dont-Know-JS/apA.md at 2nd-ed · getify/You-Dont-Know-JS](https://github.com/getify/You-Dont-Know-JS/blob/2nd-ed/scope-closures/apA.md#the-case-for-var)

[why many examples of javascript still using 'var' instead of 'const' and 'let'?](https://stackoverflow.com/questions/65663361/why-many-examples-of-javascript-still-using-var-instead-of-const-and-let)

[Can I completely stop using var?](https://stackoverflow.com/questions/50335497/can-i-completely-stop-using-var)

[What are some reasons to use var instead of let in javascript?](https://stackoverflow.com/questions/41031342/what-are-some-reasons-to-use-var-instead-of-let-in-javascript)
